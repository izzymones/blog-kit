<!DOCTYPE html>

<html>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
    Telescope Project Notes - Izzy&#39;s Blog
    
  </title>

  <meta name="description" content="### FITS File Format Telescope images are usually encoded in [Flexible Image Transport System (fits)](https://fits.gsfc.nasa.gov/fits_home.html) files. ### G...">

  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="/blog-kit/assets/vendor/bootstrap/css/bootstrap.min.css">

  <link rel="stylesheet" href="/blog-kit/assets/vendor/fontawesome-free/css/all.min.css">

  <link rel="stylesheet" href="/blog-kit/assets/main.css">
  <link rel="canonical" href="https://izzymones.github.io/blog-kit/pages/telescopeNotes/">
  <link rel="alternate" type="application/rss+xml" title="Izzy&#39;s Blog" href="/blog-kit/feed.xml">

  
  <link rel=stylesheet href="https://unpkg.com/smartdown/dist/lib/smartdown.css">
<link rel=stylesheet href="https://unpkg.com/smartdown/dist/lib/fonts.css">
<script type="text/javascript" src="https://unpkg.com/smartdown/dist/lib/smartdown.js">
</script>
<script type="text/javascript" src="https://unpkg.com/smartdown/dist/lib/calc_handlers.js"></script>
<script type="text/x-smartdown" id="Home">
### FITS File Format
Telescope images are usually encoded in [Flexible Image Transport System (fits)](https://fits.gsfc.nasa.gov/fits_home.html) files.  

### Getting Telescope Image Files

[JWST User Documentation](https://jwst-docs.stsci.edu) is a helpful site for answering questions about files and the archive. 

Get files from the [MAST archive](https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html).  There's a lot know about finding the right files on this site.  Will write something up about it eventually.  This [tutorial](https://www.space.com/james-webb-space-telescope-image-editing) is helpful when getting started.

When you're picking files to download, there are all kind of `.fits` files and most of them aren't 2D pictures.  So far I found that `i2d.fits` files are pictures.  There are probably other image/picture files that will also work.  `i2d.fits` means **2D resampled image**. The resampled part I believe means that the image has Stage 3 processing.  That's when multiple images from different filters have been processed so they are aligned and can be layered in a picture.  There needs to be some processing and tweaking to get pictures from different filters to line up into one picture I guess.  Stage 1 and Stage 2 images may not be stackable.  You can filter for Stage 3 in the Mast Archive.  I think you get this by picking **Calibration** Level 3 in the search filter.

[JWST Product Types](https://jwst-pipeline.readthedocs.io/en/latest/jwst/data_products/product_types.html) explains all the different types of `.fits` files.  They call them *products* like they're a big retail company. We're using Stage 3 products.


You can learn about the different [filters](https://jwst-docs.stsci.edu/jwst-mid-infrared-instrument/miri-instrumentation/miri-filters-and-dispersers) here.  Oooh ... cool.

The file download process doesn't work in Safari but does work in Chrome.  

### Looking at the Files

[FitsLiberator](https://noirlab.edu/public/products/fitsliberator/) is the best way to quickly look at your files. You can adjust the grayscale distribution easily here.  It's free, easy to install and use.  Theres a MAC `.dmg` download for install on a Mac.

### Image Processing for making Pictures

The image data is for astronomers to do science.  The actual array values are not always best for creating a good picture for human eyes.  FitsLiberator has a [page](https://esahubble.org/projects/fits_liberator/improc/) with good starting ideas for this.  I haven't found great resources on this but google 'contrast stretching' and 'stretch functions'.

### Displaying Files in a Web Browser

OK, here's the tricky part.  I have no idea how to do this.  I found two libraries posted on the web to read `.fits` files in javascript.  There's [fitsjs](https://github.com/astrojs/fitsjs) which hasn't been updated since 2015.  It's someones personal project rather than a professional piece of work.  I also found [Clearsky](http://www.clearskyinstitute.com/fits/), again, not confidence inspiring. So we can try these out and see if they're adequate.  We may be better off just writing a library ourselves.  Fits files have an ASCII header and then the image array which is encoded in binary.  The ASCII header would be easy to read and there are good javascript libraries for reading binary files so I think it wouldn't be too hard.  FITS files aren't compressed so I believe the binary part is just a big multi-dimensional array.  For an image, a big 2D array of grayscale values.  

Most astronomers and their data processing folks appear to use Python for processing and displaying fits files so there are very good python libs available.  I played around with [astropy](https://www.astropy.org) and it's very easy to use.  It uses the `numpy` and `matplotlib` to manage the data once it's read in.  You can install `astropy` with the following command line.

```
pip3 install astropy
```
You can check if the install worked by typing `python3` at the command line and then at the python prompt
```
import astropy
```
If you don't get an error then you're good to go.

You'll need `numpy` and `matplotlib` to use it.  I already had them so I didn't get any errors.  It may install them automatically as dependencies, but if you get errors looking for these python libraries try:
```
pip3 install numpy
pip3 install matplotlib
```

A [cute lessson plan](https://philuttley.github.io/prog4aa_lesson2/10-fitsfiles/index.html) for reading a `.fits` file with `astropy`.  Also the [astropy site](https://www.astropy.org/) has lots of documentation.

For a first stab at this I'm going to read in an image file and just spit out the data array in `json` and see how big the file is.  If it's not that big then we can read the `json` in from javascript and get started messing with pictures in a canvas.  Later we can come up with a better way.



</script>

  

  
</head>


<body>

  <!-- Navigation -->

<nav class="noheadernavbar navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">

  <div class="container">
    <a class="navbar-brand" href="/blog-kit/">  
      <!-- <img src="/blog-kit/assets/images/wildthinksLogo.svg" height="30"> -->
    </a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      
      <ul class="noheadernav navbar-nav ml-auto">
      
        <li class="nav-item">
          <a class="nav-link" href="/blog-kit/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog-kit/pages/About/">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog-kit/posts">Blog</a>
        </li>
      </ul>
    </div>
  </div>
</nav>



  <!-- Page Header -->

<header id="header-wrapper" class="masthead noheader">
</header>  
  



  <div id="smartdown-outer-container"class="container-fluid smartdown-outer-container smartdown-theme-blogx">
    <div class="row">
      <div class="col-xs-12 smartdown-container" id="blog-content">
      <!-- <div class="col-lg-8 col-md-10 mx-auto smartdown-container" id="blog-content"> -->


      </div>
    </div>
  </div>


  <!-- Footer -->

<hr>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <ul class="list-inline text-center">
          
          <li class="list-inline-item">
            <a href="mailto:izzymones@gmail.com">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="far fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          
          
          
          <li class="list-inline-item">
            <a href="https://github.com/izzymones">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
        </ul>
        <p class="copyright text-muted">Copyright &copy; Isidore Mones 2024</p>
      </div>
    </div>
  </div>
</footer>


  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/blog-kit/assets/vendor/startbootstrap-clean-blog/js/scripts.js"></script>

<script src="/blog-kit/assets/scripts.js"></script>




  
  <script>
  /* global smartdown */
  var baseURL = '/blog-kit/';
  var icons = {
    'hypercube': `/assets/images/Hypercube.svg`,
    'StalactiteStalagmite': `/assets/images/StalactiteStalagmite.svg`
  };

  var multiparts = null;
  var current = null;


  function cardLoaded(url, cardKeySubhash, sourceText) {
    /* eslint no-invalid-this: 0 */
    sourceText = sourceText.trim();
    multiparts = smartdown.partitionMultipart(sourceText);

    if (url.endsWith('.md')) {
      const newPath = url.replace(/\.md$/, '/');
      current = newPath;
      history.pushState(null, null, newPath);
    }

    var output = document.getElementById('blog-content');
    smartdown.setHome(multiparts._default_, output, function() {
      document.body.scrollTop = 0; // For Chrome, Safari and Opera
      document.documentElement.scrollTop = 0; // For IE and Firefox

      if (cardKeySubhash) {
        const target = document.getElementById(cardKeySubhash);
        if (target) {
          target.scrollIntoView();
        }
      }

      smartdown.startAutoplay(output);
    });
  }

  function loadURL(url) {
    var oReq = new XMLHttpRequest();
    let cardKeySubhash = null;
    const hashPos = url.indexOf('#');
    if (hashPos >= 0) {
      cardKeySubhash = url.slice(hashPos + 1);
    }

    oReq.addEventListener('load', function() {
      cardLoaded(url, cardKeySubhash, this.responseText);
    });
    oReq.open('GET', url);
    oReq.send();
  }

  function loadInline() {
    smartdown.loadCardsFromDocumentScripts();
    var s = smartdown.smartdownScripts[0];

    cardLoaded(window.location.href, window.location.hash.slice(1), s.text);
  }

  function cardLoader(cardKey) {
    console.log('cardLoader', cardKey);
    var part = multiparts[cardKey];
    if (part) {
      var output = document.getElementById('blog-content');
      smartdown.setHome(part, output, function() {
        smartdown.startAutoplay(output);
      });
    }
    else {
      var cardURL = cardKey;
      if (cardKey.indexOf('http') === 0) {
        cardURL = cardKey;
      }
      else {
        const expanded = smartdown.expandHrefWithLinkRules(cardURL);
        // console.log('cardloader', cardURL, expanded);
        cardURL = expanded;
      }
      // else if (cardKey.indexOf('/posts') === 0) {
      //   cardURL = `${baseURL}${cardKey}`;
      //   console.log('cardLoader', cardKey, cardURL);
      // }
      loadURL(cardURL);
    }
  }

  var calcHandlers = smartdown.defaultCalcHandlers;
  const linkRules = [
    {
      prefix: '/posts/',
      replace: baseURL + '/posts/',
    },
    {
      prefix: '/pages/',
      replace: baseURL + '/pages/',
    },
    {
      prefix: '/assets/',
      replace: baseURL + '/assets/',
    },
  ];



  window.addEventListener(
    'popstate',
    function(event) {
      console.log('popstate', event);
      // const url = document.location.pathname;
      // if (url.endsWith('/')) {
      //   const newPath = url.replace(/\/$/, '.md');
      //   // console.log('popstatex: ', url, newPath, current, window.location.hash);
      //   if (current && url !== current) {
      //     loadURL(newPath);
      //   }
      // }
    },
    false);
  // window.addEventListener(
  //   'hashchange',
  //   function(event) {
  //     console.log(
  //       'hashchange document.location.pathname: ' + document.location.pathname,
  //       JSON.stringify(event.state));
  //   },
  //   false);

  smartdown.initialize(icons, `https://unpkg.com/smartdown/dist/`, loadInline, cardLoader, calcHandlers, linkRules);
</script>

  

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX-X"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-XXXXXXXXX-X');
</script>



</body>

</html>
